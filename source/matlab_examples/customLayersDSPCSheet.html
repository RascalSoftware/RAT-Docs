<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2024b"><title>Custom Layers Example for Supported DSPC layer.</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 15px 10px 0; display: inline-block }
.S2 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S3 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S4 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif, Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
<<<<<<< HEAD
.S6 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Custom Layers Example for Supported DSPC layer.</span></h1><div  class = 'S1'><span>Example of using Custom layers to model a DSPC supportd bilayer.</span></div><div  class = 'S1'><span>Start by making the class and setting it to a custom layers type:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >problem = createProject(name=</span><span style="color: #a709f5;">'oDSPC - Custom Layers'</span><span >, calcType=</span><span style="color: #a709f5;">'normal'</span><span >, model=</span><span style="color: #a709f5;">'custom layers'</span><span >, geometry=</span><span style="color: #a709f5;">'substrate/liquid'</span><span >, absorption=false);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >problem.showPriors = true;</span></span></div></div></div><div  class = 'S1'><span>For a custom layers model, rather than being forced to define out layers as [Thick SLD Rough.... etc], we can parameterise however we like and then use a function to calculate the [d rho sigma] arrangement for each layer. So for example, if the volume of lipid tails are known (from the literature), then all we need is the Area per molecule, because then....</span></div><div  class = 'S1'><span mathmlencoding="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot;&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;d&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;V&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;APM&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/math&gt;" style="vertical-align:-15px"><img src="data:image/png;base64,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" width="62.5" height="36" /></span><span>,</span></div><div  class = 'S1'><span>where d is the thickness and V is the volume.</span></div><div  class = 'S1'><span>Likewise, the SLD is</span></div><div  class = 'S1'><span mathmlencoding="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mi&gt;ρ&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mrow&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;V&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/math&gt;" style="vertical-align:-15px"><img src="data:image/png;base64,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" width="72.5" height="55.5" /></span></div><div  class = 'S1'><span>as usual.</span></div><div  class = 'S1'><span>In this folder there is a pre-prepared Matlab custom model for a DSPC on a Silicon substrate. We can display it here to see what we mean.....</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >type(</span><span style="color: #a709f5;">'customBilayerDSPC'</span><span >)</span></span></div></div></div><div  class = 'S5'><span>We need to add the parameters we are going to need to define the model (note that Substrate Roughness' always exists as parameter 1 as before, and that we are setting a Gaussian prior on Head Hydration here).</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >Parameters = {</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >    </span><span style="color: #008013;">%       Name                min         val         max     fit? </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        {</span><span style="color: #a709f5;">'Oxide thick'</span><span >,         5,          20,         60,     true   };</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        {</span><span style="color: #a709f5;">'Oxide Hydration'</span><span >      0,          0.2,        0.5,    true   };</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        {</span><span style="color: #a709f5;">'Lipid APM'</span><span >            45          55          65      true   };</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        {</span><span style="color: #a709f5;">'Head Hydration'</span><span >       0           0.2         0.7     true   </span><span style="color: #a709f5;">'gaussian'</span><span >   0.3     0.03};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        {</span><span style="color: #a709f5;">'Bilayer Hydration'</span><span >    0           0.1         0.2     true   };</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        {</span><span style="color: #a709f5;">'Bilayer Roughness'</span><span >    2           4           8       true   };</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        {</span><span style="color: #a709f5;">'Water Thickness'</span><span >      0           2           10      true   };</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        };</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span > problem.addParameterGroup(Parameters);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span > problem.setParameter(1,</span><span style="color: #a709f5;">'min'</span><span >,1,</span><span style="color: #a709f5;">'max'</span><span >,10); </span><span style="color: #008013;">% Change the substrate roughness limits</span></span></div></div></div><div  class = 'S1'><span>Need to add the relevant Bulk SLD's. Change the bulk in from air to silicon, and add two additional water contrasts:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: #008013;">% Change bulk in from air to silicon....</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setBulkIn(1,</span><span style="color: #a709f5;">'name'</span><span >,</span><span style="color: #a709f5;">'Silicon'</span><span >,</span><span style="color: #a709f5;">'min'</span><span >,2.07e-6,</span><span style="color: #a709f5;">'value'</span><span >,2.073e-6,</span><span style="color: #a709f5;">'max'</span><span >,2.08e-6,</span><span style="color: #a709f5;">'fit'</span><span >,false);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% Add two more values for bulk out....</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addBulkOut(</span><span style="color: #a709f5;">'SLD SMW'</span><span >,1e-6,2.073e-6,3e-6,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addBulkOut(</span><span style="color: #a709f5;">'SLD H2O'</span><span >,-0.6e-6,-0.56e-6,-0.3e-6,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >problem.setBulkOut(1,</span><span style="color: #a709f5;">'fit'</span><span >,true,</span><span style="color: #a709f5;">'min'</span><span >,5e-6);</span></span></div></div></div><div  class = 'S1'><span>Now add the datafiles. We have three datasets we need to consider - the bilayer against D2O, Silicon Matched water and H2O. Load these datafiles in and put them in the data block....</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: #008013;">% Read in the datafiles</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >D2O_data = dlmread(</span><span style="color: #a709f5;">'c_PLP0016596.dat'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >SMW_data = dlmread(</span><span style="color: #a709f5;">'c_PLP0016601.dat'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >H2O_data = dlmread(</span><span style="color: #a709f5;">'c_PLP0016607.dat'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% Add the data to the project</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addData(</span><span style="color: #a709f5;">'Bilayer / D2O'</span><span >, D2O_data);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addData(</span><span style="color: #a709f5;">'Bilayer / SMW'</span><span >, SMW_data);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addData(</span><span style="color: #a709f5;">'Bilayer / H2O'</span><span >, H2O_data);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setData(2,</span><span style="color: #a709f5;">'dataRange'</span><span >,[0.013 0.37]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setData(3,</span><span style="color: #a709f5;">'dataRange'</span><span >,[0.013 0.37]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >problem.setData(4,</span><span style="color: #a709f5;">'dataRange'</span><span >,[0.013 0.37]);</span></span></div></div></div><div  class = 'S1'><span>Add the custom file to the project....                         </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >problem.addCustomFile(</span><span style="color: #a709f5;">'DSPC Model'</span><span >, </span><span style="color: #a709f5;">'customBilayerDSPC.m'</span><span >, </span><span style="color: #a709f5;">'matlab'</span><span >, pwd);</span></span></div></div></div><div  class = 'S1'><span>Also, add the relevant background parameters - one each for each contrast:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: #008013;">% Change the name of the existing parameters to refer to D2O</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setBackgroundParam(1,</span><span style="color: #a709f5;">'name'</span><span >,</span><span style="color: #a709f5;">'Backs par D2O'</span><span >,</span><span style="color: #a709f5;">'fit'</span><span >,true,</span><span style="color: #a709f5;">'min'</span><span >,1e-10,</span><span style="color: #a709f5;">'max'</span><span >,1e-5,</span><span style="color: #a709f5;">'val'</span><span >,1e-6);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% Add two new backs parameters for the other two..</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addBackgroundParam(</span><span style="color: #a709f5;">'Backs par SMW'</span><span >,1e-10,1e-6,1e-5,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addBackgroundParam(</span><span style="color: #a709f5;">'Backs par H2O'</span><span >,1e-10,1e-6,1e-5,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% And add the two new constant backgrounds..</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addBackground(</span><span style="color: #a709f5;">'Background SMW'</span><span >,</span><span style="color: #a709f5;">'constant'</span><span >,</span><span style="color: #a709f5;">'Backs par SMW'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addBackground(</span><span style="color: #a709f5;">'Background H2O'</span><span >,</span><span style="color: #a709f5;">'constant'</span><span >,</span><span style="color: #a709f5;">'Backs par H2O'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% And edit the other one....</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setBackgroundName(1,</span><span style="color: #a709f5;">'Background D2O'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setBackground(1,</span><span style="color: #a709f5;">'source'</span><span >,</span><span style="color: #a709f5;">'Backs par D2O'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% Finally modify some of the other parameters </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% Set the scalefactor...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setScalefactor(1,</span><span style="color: #a709f5;">'Value'</span><span >,1,</span><span style="color: #a709f5;">'min'</span><span >,0.5,</span><span style="color: #a709f5;">'max'</span><span >,2,</span><span style="color: #a709f5;">'fit'</span><span >,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'>&nbsp;</div></div></div><div  class = 'S5'><span>We need to use the data resolution (i.e. the fourch column of our datafiles). Do do this, we need to add a 'Data' resolution object to our resolutions table...</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >problem.addResolution(</span><span style="color: #a709f5;">'Data Resolution'</span><span >,</span><span style="color: #a709f5;">'data'</span><span >);</span></span></div></div></div><div  class = 'S1'><span>Now add the three contrasts as before:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: #008013;">% D2O contrast..</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addContrast(</span><span style="color: #a709f5;">'name'</span><span >,        </span><span style="color: #a709f5;">'Bilayer / D2O'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'background'</span><span >,  </span><span style="color: #a709f5;">'Background D2O'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'resolution'</span><span >,  </span><span style="color: #a709f5;">'Data Resolution'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'scalefactor'</span><span >, </span><span style="color: #a709f5;">'Scalefactor 1'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'BulkOut'</span><span >,     </span><span style="color: #a709f5;">'SLD D2O'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'BulkIn'</span><span >,      </span><span style="color: #a709f5;">'Silicon'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'data'</span><span >,        </span><span style="color: #a709f5;">'Bilayer / D2O'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% SMW contrast..</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addContrast(</span><span style="color: #a709f5;">'name'</span><span >,        </span><span style="color: #a709f5;">'Bilayer / SMW'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'background'</span><span >,  </span><span style="color: #a709f5;">'Background SMW'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'resolution'</span><span >,  </span><span style="color: #a709f5;">'Data Resolution'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'scalefactor'</span><span >, </span><span style="color: #a709f5;">'Scalefactor 1'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'BulkOut'</span><span >,     </span><span style="color: #a709f5;">'SLD SMW'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'BulkIn'</span><span >,      </span><span style="color: #a709f5;">'Silicon'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'data'</span><span >,        </span><span style="color: #a709f5;">'Bilayer / SMW'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% SMW contrast..</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addContrast(</span><span style="color: #a709f5;">'name'</span><span >,        </span><span style="color: #a709f5;">'Bilayer / H2O'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'background'</span><span >,  </span><span style="color: #a709f5;">'Background H2O'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'resolution'</span><span >,  </span><span style="color: #a709f5;">'Data Resolution'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'scalefactor'</span><span >, </span><span style="color: #a709f5;">'Scalefactor 1'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'BulkOut'</span><span >,     </span><span style="color: #a709f5;">'SLD H2O'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'BulkIn'</span><span >,      </span><span style="color: #a709f5;">'Silicon'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'data'</span><span >,        </span><span style="color: #a709f5;">'Bilayer / H2O'</span><span >);</span></span></div></div></div><div  class = 'S1'><span>This time, to set the model, we point to the custom file we've just added to the project.....</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >problem.setContrastModel(1,</span><span style="color: #a709f5;">'DSPC Model'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setContrastModel(2,</span><span style="color: #a709f5;">'DSPC Model'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >problem.setContrastModel(3,</span><span style="color: #a709f5;">'DSPC Model'</span><span >);</span></span></div></div></div><div  class = 'S5'><span>Look at the complete model definition before sending it to RAT;</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >disp(problem)</span></span></div></div></div><div  class = 'S1'><span>To run it, we need to make a controls block....</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >controls = controlsClass()</span></span></div></div></div><div  class = 'S1'><span>And send this to RAT...</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >[problem,results] = RAT(problem,controls);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >plotRefSLD(problem,results);</span></span></div></div></div><div  class = 'S1'><span>Our guess values were not too bad here. We can proceed directly to the Bayesian Analysis.....</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >controls.procedure = </span><span style="color: #a709f5;">'dream'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >controls.nSamples = 25000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >controls.parallel = </span><span style="color: #a709f5;">'contrasts'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >controls.adaptPCR = true</span></span></div></div></div><div  class = 'S5'><span>Send this to RAT....</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >[problem,results] = RAT(problem,controls);</span></span></div></div></div><div  class = 'S1'><span>Now plot our the results....</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >h1 = figure;    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >bayesShadedPlot(problem, results,</span><span style="color: #a709f5;">'KeepAxes'</span><span >,true,</span><span style="color: #a709f5;">'interval'</span><span >,65,</span><span style="color: #a709f5;">'q4'</span><span >,false);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >h2 = figure;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >plotHists(results,h2,</span><span style="color: #a709f5;">'smooth'</span><span >,true)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >h3 = figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >mcmcplot(results.chain,[],results.fitNames,</span><span style="color: #a709f5;">'chainpanel'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >h4 = figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >cornerPlot(results,h4,</span><span style="color: #a709f5;">'smooth'</span><span >,false)</span></span></div></div></div><div  class = 'S5'><span>...and we're done.</span></div>
=======
.S6 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace, Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Custom Layers Example for Supported DSPC layer.</span></h1><div  class = 'S1'><span>Example of using Custom layers to model a DSPC supportd bilayer.</span></div><div  class = 'S1'><span>Start by making the class and setting it to a custom layers type:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >problem = createProject(name=</span><span style="color: #a709f5;">'oDSPC - Custom Layers'</span><span >, calcType=</span><span style="color: #a709f5;">'normal'</span><span >, model=</span><span style="color: #a709f5;">'custom layers'</span><span >, geometry=</span><span style="color: #a709f5;">'substrate/liquid'</span><span >, absorption=false);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >problem.showPriors = true;</span></span></div></div></div><div  class = 'S1'><span>For a custom layers model, rather than being forced to define out layers as [Thick SLD Rough.... etc], we can parameterise however we like and then use a function to calculate the [d rho sigma] arrangement for each layer. So for example, if the volume of lipid tails are known (from the literature), then all we need is the Area per molecule, because then....</span></div><div  class = 'S1'><span mathmlencoding="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;inline&quot;&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;d&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;V&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;APM&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/math&gt;" style="vertical-align:-15px"><img src="data:image/png;base64,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" width="62.5" height="36" /></span><span>,</span></div><div  class = 'S1'><span>where d is the thickness and V is the volume.</span></div><div  class = 'S1'><span>Likewise, the SLD is</span></div><div  class = 'S1'><span mathmlencoding="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mi&gt;ρ&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mrow&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;italic&quot;&gt;V&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/math&gt;" style="vertical-align:-15px"><img src="data:image/png;base64,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" width="72.5" height="55.5" /></span></div><div  class = 'S1'><span>as usual.</span></div><div  class = 'S1'><span>In this folder there is a pre-prepared Matlab custom model for a DSPC on a Silicon substrate. We can display it here to see what we mean.....</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >type(</span><span style="color: #a709f5;">'customBilayerDSPC'</span><span >)</span></span></div></div></div><div  class = 'S5'><span>We need to add the parameters we are going to need to define the model (note that Substrate Roughness' always exists as parameter 1 as before, and that we are setting a Gaussian prior on Head Hydration here).</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >Parameters = {</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >    </span><span style="color: #008013;">%       Name                min         val         max     fit? </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        {</span><span style="color: #a709f5;">'Oxide thick'</span><span >,         5,          20,         60,     true   };</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        {</span><span style="color: #a709f5;">'Oxide Hydration'</span><span >      0,          0.2,        0.5,    true   };</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        {</span><span style="color: #a709f5;">'Lipid APM'</span><span >            45          55          65      true   };</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        {</span><span style="color: #a709f5;">'Head Hydration'</span><span >       0           0.2         0.7     true   </span><span style="color: #a709f5;">'gaussian'</span><span >   0.3     0.03};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        {</span><span style="color: #a709f5;">'Bilayer Hydration'</span><span >    0           0.1         0.2     true   };</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        {</span><span style="color: #a709f5;">'Bilayer Roughness'</span><span >    2           4           8       true   };</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        {</span><span style="color: #a709f5;">'Water Thickness'</span><span >      0           2           10      true   };</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >        };</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span > problem.addParameterGroup(Parameters);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span > problem.setParameter(1,</span><span style="color: #a709f5;">'min'</span><span >,1,</span><span style="color: #a709f5;">'max'</span><span >,10); </span><span style="color: #008013;">% Change the substrate roughness limits</span></span></div></div></div><div  class = 'S1'><span>Need to add the relevant Bulk SLD's. Change the bulk in from air to silicon, and add two additional water contrasts:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: #008013;">% Change bulk in from air to silicon....</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setBulkIn(1,</span><span style="color: #a709f5;">'name'</span><span >,</span><span style="color: #a709f5;">'Silicon'</span><span >,</span><span style="color: #a709f5;">'min'</span><span >,2.07e-6,</span><span style="color: #a709f5;">'value'</span><span >,2.073e-6,</span><span style="color: #a709f5;">'max'</span><span >,2.08e-6,</span><span style="color: #a709f5;">'fit'</span><span >,false);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% Add two more values for bulk out....</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addBulkOut(</span><span style="color: #a709f5;">'SLD SMW'</span><span >,1e-6,2.073e-6,3e-6,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addBulkOut(</span><span style="color: #a709f5;">'SLD H2O'</span><span >,-0.6e-6,-0.56e-6,-0.3e-6,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >problem.setBulkOut(1,</span><span style="color: #a709f5;">'fit'</span><span >,true,</span><span style="color: #a709f5;">'min'</span><span >,5e-6);</span></span></div></div></div><div  class = 'S1'><span>Now add the datafiles. We have three datasets we need to consider - the bilayer against D2O, Silicon Matched water and H2O. Load these datafiles in and put them in the data block....</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: #008013;">% Read in the datafiles</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >D2O_data = dlmread(</span><span style="color: #a709f5;">'c_PLP0016596.dat'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >SMW_data = dlmread(</span><span style="color: #a709f5;">'c_PLP0016601.dat'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >H2O_data = dlmread(</span><span style="color: #a709f5;">'c_PLP0016607.dat'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% Add the data to the project</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addData(</span><span style="color: #a709f5;">'Bilayer / D2O'</span><span >, D2O_data);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addData(</span><span style="color: #a709f5;">'Bilayer / SMW'</span><span >, SMW_data);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addData(</span><span style="color: #a709f5;">'Bilayer / H2O'</span><span >, H2O_data);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setData(2,</span><span style="color: #a709f5;">'dataRange'</span><span >,[0.013 0.37]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setData(3,</span><span style="color: #a709f5;">'dataRange'</span><span >,[0.013 0.37]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >problem.setData(4,</span><span style="color: #a709f5;">'dataRange'</span><span >,[0.013 0.37]);</span></span></div></div></div><div  class = 'S1'><span>Add the custom file to the project....                         </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >problem.addCustomFile(</span><span style="color: #a709f5;">'DSPC Model'</span><span >, </span><span style="color: #a709f5;">'customBilayerDSPC.m'</span><span >, </span><span style="color: #a709f5;">'matlab'</span><span >, pwd);</span></span></div></div></div><div  class = 'S1'><span>Also, add the relevant background parameters - one each for each contrast:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: #008013;">% Change the name of the existing parameters to refer to D2O</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setBackgroundParam(1,</span><span style="color: #a709f5;">'name'</span><span >,</span><span style="color: #a709f5;">'Backs par D2O'</span><span >,</span><span style="color: #a709f5;">'fit'</span><span >,true,</span><span style="color: #a709f5;">'min'</span><span >,1e-10,</span><span style="color: #a709f5;">'max'</span><span >,1e-5,</span><span style="color: #a709f5;">'val'</span><span >,1e-6);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% Add two new backs parameters for the other two..</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addBackgroundParam(</span><span style="color: #a709f5;">'Backs par SMW'</span><span >,1e-10,1e-6,1e-5,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addBackgroundParam(</span><span style="color: #a709f5;">'Backs par H2O'</span><span >,1e-10,1e-6,1e-5,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% And add the two new constant backgrounds..</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addBackground(</span><span style="color: #a709f5;">'Background SMW'</span><span >,</span><span style="color: #a709f5;">'constant'</span><span >,</span><span style="color: #a709f5;">'Backs par SMW'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addBackground(</span><span style="color: #a709f5;">'Background H2O'</span><span >,</span><span style="color: #a709f5;">'constant'</span><span >,</span><span style="color: #a709f5;">'Backs par H2O'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% And edit the other one....</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setBackgroundName(1,</span><span style="color: #a709f5;">'Background D2O'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setBackground(1,</span><span style="color: #a709f5;">'source'</span><span >,</span><span style="color: #a709f5;">'Backs par D2O'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% Finally modify some of the other parameters </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% Set the scalefactor...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setScalefactor(1,</span><span style="color: #a709f5;">'Value'</span><span >,1,</span><span style="color: #a709f5;">'min'</span><span >,0.5,</span><span style="color: #a709f5;">'max'</span><span >,2,</span><span style="color: #a709f5;">'fit'</span><span >,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'>&nbsp;</div></div></div><div  class = 'S5'><span>We need to use the data resolution (i.e. the fourch column of our datafiles). Do do this, we need to add a 'Data' resolution object to our resolutions table...</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >problem.addResolution(</span><span style="color: #a709f5;">'Data Resolution'</span><span >,</span><span style="color: #a709f5;">'data'</span><span >);</span></span></div></div></div><div  class = 'S1'><span>Now add the three contrasts as before:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: #008013;">% D2O contrast..</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addContrast(</span><span style="color: #a709f5;">'name'</span><span >,        </span><span style="color: #a709f5;">'Bilayer / D2O'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'background'</span><span >,  </span><span style="color: #a709f5;">'Background D2O'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'resolution'</span><span >,  </span><span style="color: #a709f5;">'Data Resolution'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'scalefactor'</span><span >, </span><span style="color: #a709f5;">'Scalefactor 1'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'BulkOut'</span><span >,     </span><span style="color: #a709f5;">'SLD D2O'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'BulkIn'</span><span >,      </span><span style="color: #a709f5;">'Silicon'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'data'</span><span >,        </span><span style="color: #a709f5;">'Bilayer / D2O'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% SMW contrast..</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addContrast(</span><span style="color: #a709f5;">'name'</span><span >,        </span><span style="color: #a709f5;">'Bilayer / SMW'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'background'</span><span >,  </span><span style="color: #a709f5;">'Background SMW'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'resolution'</span><span >,  </span><span style="color: #a709f5;">'Data Resolution'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'scalefactor'</span><span >, </span><span style="color: #a709f5;">'Scalefactor 1'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'BulkOut'</span><span >,     </span><span style="color: #a709f5;">'SLD SMW'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'BulkIn'</span><span >,      </span><span style="color: #a709f5;">'Silicon'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'data'</span><span >,        </span><span style="color: #a709f5;">'Bilayer / SMW'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: #008013;">% SMW contrast..</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.addContrast(</span><span style="color: #a709f5;">'name'</span><span >,        </span><span style="color: #a709f5;">'Bilayer / H2O'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'background'</span><span >,  </span><span style="color: #a709f5;">'Background H2O'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'resolution'</span><span >,  </span><span style="color: #a709f5;">'Data Resolution'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'scalefactor'</span><span >, </span><span style="color: #a709f5;">'Scalefactor 1'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'BulkOut'</span><span >,     </span><span style="color: #a709f5;">'SLD H2O'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'BulkIn'</span><span >,      </span><span style="color: #a709f5;">'Silicon'</span><span >,</span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >                    </span><span style="color: #a709f5;">'data'</span><span >,        </span><span style="color: #a709f5;">'Bilayer / H2O'</span><span >);</span></span></div></div></div><div  class = 'S1'><span>This time, to set the model, we point to the custom file we've just added to the project.....</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >problem.setContrastModel(1,</span><span style="color: #a709f5;">'DSPC Model'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >problem.setContrastModel(2,</span><span style="color: #a709f5;">'DSPC Model'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >problem.setContrastModel(3,</span><span style="color: #a709f5;">'DSPC Model'</span><span >);</span></span></div></div></div><div  class = 'S5'><span>Look at the complete model definition before sending it to RAT;</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >disp(problem)</span></span></div></div></div><div  class = 'S1'><span>To run it, we need to make a controls block....</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >controls = controlsClass()</span></span></div></div></div><div  class = 'S1'><span>And send this to RAT...</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >[problem,results] = RAT(problem,controls);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >plotRefSLD(problem,results);</span></span></div></div></div><div  class = 'S1'><span>Our guess values were not too bad here. We can proceed directly to the Bayesian Analysis.....</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >controls.procedure = </span><span style="color: #a709f5;">'dream'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >controls.nSamples = 25000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >controls.parallel = </span><span style="color: #a709f5;">'contrasts'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >controls.adaptPCR = true</span></span></div></div></div><div  class = 'S5'><span>Send this to RAT....</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >[problem,results] = RAT(problem,controls);</span></span></div></div></div><div  class = 'S1'><span>Now plot our the results....</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >h1 = figure;    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >bayesShadedPlot(problem, results,</span><span style="color: #a709f5;">'KeepAxes'</span><span >,true,</span><span style="color: #a709f5;">'interval'</span><span >,65,</span><span style="color: #a709f5;">'q4'</span><span >,false);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >h2 = figure;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >plotHists(results,h2,</span><span style="color: #a709f5;">'smooth'</span><span >,true)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >h3 = figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >mcmcplot(results.chain,[],results.fitNames,</span><span style="color: #a709f5;">'chainpanel'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >h4 = figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >cornerPlot(results,h4,</span><span style="color: #a709f5;">'smooth'</span><span >,false)</span></span></div></div></div><div  class = 'S5'><span>...and we're done.</span></div>
>>>>>>> ec975846 (added livescripts to matlab examples)
<br>
<!-- 
##### SOURCE BEGIN #####
%% Custom Layers Example for Supported DSPC layer.
% Example of using Custom layers to model a DSPC supportd bilayer.
% 
% Start by making the class and setting it to a custom layers type:

problem = createProject(name='oDSPC - Custom Layers', calcType='normal', model='custom layers', geometry='substrate/liquid', absorption=false);
problem.showPriors = true;
%% 
% For a custom layers model, rather than being forced to define out layers as 
% [Thick SLD Rough.... etc], we can parameterise however we like and then use 
% a function to calculate the [d rho sigma] arrangement for each layer. So for 
% example, if the volume of lipid tails are known (from the literature), then 
% all we need is the Area per molecule, because then....
% 
% $d=\frac{V}{\textrm{APM}}$,
% 
% where d is the thickness and V is the volume.
% 
% Likewise, the SLD is
% 
% $$\rho =\frac{\sum_i n_i b_i }{V}$$
% 
% as usual.
% 
% In this folder there is a pre-prepared Matlab custom model for a DSPC on a 
% Silicon substrate. We can display it here to see what we mean.....

type('customBilayerDSPC')
%% 
% We need to add the parameters we are going to need to define the model (note 
% that Substrate Roughness' always exists as parameter 1 as before, and that we 
% are setting a Gaussian prior on Head Hydration here).

Parameters = {
    %       Name                min         val         max     fit? 
        {'Oxide thick',         5,          20,         60,     true   };
        {'Oxide Hydration'      0,          0.2,        0.5,    true   };
        {'Lipid APM'            45          55          65      true   };
        {'Head Hydration'       0           0.2         0.7     true   'gaussian'   0.3     0.03};
        {'Bilayer Hydration'    0           0.1         0.2     true   };
        {'Bilayer Roughness'    2           4           8       true   };
        {'Water Thickness'      0           2           10      true   };
        };
    
 problem.addParameterGroup(Parameters);
 problem.setParameter(1,'min',1,'max',10); % Change the substrate roughness limits
%% 
% Need to add the relevant Bulk SLD's. Change the bulk in from air to silicon, 
% and add two additional water contrasts:

% Change bulk in from air to silicon....
problem.setBulkIn(1,'name','Silicon','min',2.07e-6,'value',2.073e-6,'max',2.08e-6,'fit',false);

% Add two more values for bulk out....
problem.addBulkOut('SLD SMW',1e-6,2.073e-6,3e-6,true);
problem.addBulkOut('SLD H2O',-0.6e-6,-0.56e-6,-0.3e-6,true);

problem.setBulkOut(1,'fit',true,'min',5e-6);
%% 
% Now add the datafiles. We have three datasets we need to consider - the bilayer 
% against D2O, Silicon Matched water and H2O. Load these datafiles in and put 
% them in the data block....

% Read in the datafiles
D2O_data = dlmread('c_PLP0016596.dat');
SMW_data = dlmread('c_PLP0016601.dat');
H2O_data = dlmread('c_PLP0016607.dat');

% Add the data to the project
problem.addData('Bilayer / D2O', D2O_data);
problem.addData('Bilayer / SMW', SMW_data);
problem.addData('Bilayer / H2O', H2O_data);

problem.setData(2,'dataRange',[0.013 0.37]);
problem.setData(3,'dataRange',[0.013 0.37]);
problem.setData(4,'dataRange',[0.013 0.37]);
%% 
% Add the custom file to the project....                         

problem.addCustomFile('DSPC Model', 'customBilayerDSPC.m', 'matlab', pwd);
%% 
% Also, add the relevant background parameters - one each for each contrast:

% Change the name of the existing parameters to refer to D2O
problem.setBackgroundParam(1,'name','Backs par D2O','fit',true,'min',1e-10,'max',1e-5,'val',1e-6);

% Add two new backs parameters for the other two..
problem.addBackgroundParam('Backs par SMW',1e-10,1e-6,1e-5,true);
problem.addBackgroundParam('Backs par H2O',1e-10,1e-6,1e-5,true);

% And add the two new constant backgrounds..
problem.addBackground('Background SMW','constant','Backs par SMW');
problem.addBackground('Background H2O','constant','Backs par H2O');


% And edit the other one....
problem.setBackgroundName(1,'Background D2O');
problem.setBackground(1,'source','Backs par D2O');

% Finally modify some of the other parameters 

% Set the scalefactor...
problem.setScalefactor(1,'Value',1,'min',0.5,'max',2,'fit',true);

%% 
% We need to use the data resolution (i.e. the fourch column of our datafiles). 
% Do do this, we need to add a 'Data' resolution object to our resolutions table...

problem.addResolution('Data Resolution','data');
%% 
% Now add the three contrasts as before:

% D2O contrast..
problem.addContrast('name',        'Bilayer / D2O',...
                    'background',  'Background D2O',...
                    'resolution',  'Data Resolution',...
                    'scalefactor', 'Scalefactor 1',...
                    'BulkOut',     'SLD D2O',...
                    'BulkIn',      'Silicon',...
                    'data',        'Bilayer / D2O');

% SMW contrast..
problem.addContrast('name',        'Bilayer / SMW',...
                    'background',  'Background SMW',...
                    'resolution',  'Data Resolution',...
                    'scalefactor', 'Scalefactor 1',...
                    'BulkOut',     'SLD SMW',...
                    'BulkIn',      'Silicon',...
                    'data',        'Bilayer / SMW');

% SMW contrast..
problem.addContrast('name',        'Bilayer / H2O',...
                    'background',  'Background H2O',...
                    'resolution',  'Data Resolution',...
                    'scalefactor', 'Scalefactor 1',...
                    'BulkOut',     'SLD H2O',...
                    'BulkIn',      'Silicon',...
                    'data',        'Bilayer / H2O');
%% 
% This time, to set the model, we point to the custom file we've just added 
% to the project.....

problem.setContrastModel(1,'DSPC Model');
problem.setContrastModel(2,'DSPC Model');
problem.setContrastModel(3,'DSPC Model');
%% 
% Look at the complete model definition before sending it to RAT;

disp(problem)
%% 
% To run it, we need to make a controls block....

controls = controlsClass()
%% 
% And send this to RAT...

[problem,results] = RAT(problem,controls);
plotRefSLD(problem,results);
%% 
% Our guess values were not too bad here. We can proceed directly to the Bayesian 
% Analysis.....

controls.procedure = 'dream';
controls.nSamples = 25000;
controls.parallel = 'contrasts';
controls.adaptPCR = true
%% 
% Send this to RAT....

[problem,results] = RAT(problem,controls);
%% 
% Now plot our the results....

h1 = figure;    
bayesShadedPlot(problem, results,'KeepAxes',true,'interval',65,'q4',false);

h2 = figure;
plotHists(results,h2,'smooth',true)

h3 = figure
mcmcplot(results.chain,[],results.fitNames,'chainpanel');

h4 = figure
cornerPlot(results,h4,'smooth',false)
%% 
% ...and we're done.
##### SOURCE END #####
-->
</div></body></html>