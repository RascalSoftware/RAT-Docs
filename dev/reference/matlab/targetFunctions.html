
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Target Functions (Low Level API) &#8212; RAT  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=9deae167" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=881e7dcd"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/matlab/targetFunctions';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.2';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://rascalsoftware.github.io/RAT-Docs/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Minimisers" href="minimisers/index.html" />
    <link rel="prev" title="RAT Entry Functions" href="entryFunctions.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="RAT  documentation - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="RAT  documentation - Home"/>`);</script>
  
  
</a></div>
    
      <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../index.html">
                        Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../guide.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../examples.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../index.html">
                        Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../guide.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../examples.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">MATLAB API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="projectClass.html">Project Class</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="parametersClass.html">Parameters Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="resolutionsClass.html">Resolutions Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="backgroundsClass.html">Backgrounds Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="dataClass.html">Data Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="layersClass.html">Layers Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="customFileClass.html">Custom File Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="contrastsClass.html">Contrasts Class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="controlClass.html">Controls Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="entryFunctions.html">RAT Entry Functions</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Target Functions (Low Level API)</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="minimisers/index.html">Minimisers</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="minimisers/simplex.html">Simplex</a></li>
<li class="toctree-l3"><a class="reference internal" href="minimisers/de.html">Differential Evolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="minimisers/ns.html">Nested Sampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="minimisers/dream.html">DREAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="minimisers/generalUtils.html">General Minimiser Utilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plotting.html">Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html">Utilities</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../python/index.html">Python API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../python/run.html">Run</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/project.html">Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/controls.html">Controls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/classlist.html">ClassList</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/models.html">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/events.html">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/examples.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/plotting.html">Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/enums.html">Enums</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/core.html">RAT Core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/inputs.html">Inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/outputs.html">Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/wrappers.html">Wrappers</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">API Reference</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">MATLAB API Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Target...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="target-functions-low-level-api">
<h1>Target Functions (Low Level API)<a class="headerlink" href="#target-functions-low-level-api" title="Link to this heading">#</a></h1>
<dl class="mat function" id="module-targetFunctions">
<dt class="sig sig-object mat" id="targetFunctions.reflectivityCalculation">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.</span></span><span class="sig-name descname"><span class="pre">reflectivityCalculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">problemStruct</span></em>, <em class="sig-param"><span class="pre">controls</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.reflectivityCalculation" title="Link to this definition">#</a></dt>
<dd><p>Compute the reflectivity and SLD curves for a given model using the Abeles matrix formalism.</p>
<p>Main entry point into the reflectivity calculation for the toolbox.
This is the main function that is called by any of the minimisers or
analysis tools from the rest of the toolbox.</p>
<p>The main job of this function is to decide which type of calculation
(i.e. ‘Target function’) is required, and call the relevant routines.
Different model types are specified in sub functions.
The types of available target functions are:</p>
<ul class="simple">
<li><p>normal    - The main basic target function type, for non polarised neutrons (or x-rays) with non-absorbing samples.</p></li>
<li><p>domains   - Target function for samples consisting of domains which are larger than the beam lateral coherence length.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>problemStruct</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">struct</span></code></span>) – The project class as a struct (generated via parseClassToStructs)</p></li>
<li><p><strong>controls</strong> (<span><code class="xref mat mat-obj docutils literal notranslate"><span class="pre">struct</span></code></span>) – The controls struct (generated via parseClassToStructs)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong> – The results of the calculation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>struct</p>
</dd>
</dl>
</dd></dl>

<section id="common-functions">
<span id="commonfunctions"></span><h2>Common Functions<a class="headerlink" href="#common-functions" title="Link to this heading">#</a></h2>
<dl class="mat function" id="module-targetFunctions.common">
<dt class="sig sig-object mat" id="targetFunctions.common.backSort">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.common.</span></span><span class="sig-name descname"><span class="pre">backSort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">qzshiftIndex</span></em>, <em class="sig-param"><span class="pre">scalefactorIndex</span></em>, <em class="sig-param"><span class="pre">bulkInIndex</span></em>, <em class="sig-param"><span class="pre">bulkOutIndex</span></em>, <em class="sig-param"><span class="pre">qzshiftValues</span></em>, <em class="sig-param"><span class="pre">scalefactorValues</span></em>, <em class="sig-param"><span class="pre">bulkInValues</span></em>, <em class="sig-param"><span class="pre">bulkOutValues</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.common.backSort" title="Link to this definition">#</a></dt>
<dd><p>Distributes the background and shift values among the different contrasts</p>
<dl class="simple">
<dt>INPUTS:</dt><dd><ul class="simple">
<li><p>qzshiftIndex: Index of the qzshift value associated with this contrast</p></li>
<li><p>scalefactorIndex: Index of the scalefactor value  associated with this contrast</p></li>
<li><p>bulkInIndex: Index of the BulkIn value associated with this contrast</p></li>
<li><p>bulkOutIndex: Index of the BulkOut value associated with this contrast</p></li>
<li><p>qzshiftValues: List of all qzshift values</p></li>
<li><p>scalefactorValues: List of all scalefactor values</p></li>
<li><p>bulkInValues: List of all bulk In values</p></li>
<li><p>bulkOutValues: List of all bulk Out values</p></li>
</ul>
</dd>
<dt>OUTPUTS:</dt><dd><ul class="simple">
<li><p>qzshift: qzshift value for this contrast</p></li>
<li><p>scalefactor: scalefactor value for this contrast</p></li>
<li><p>bulkIn: bulk In value for this contrast</p></li>
<li><p>bulkOut: bulk Out value for this contrast</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.common.constructBackground">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.common.</span></span><span class="sig-name descname"><span class="pre">constructBackground</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">backgroundType</span></em>, <em class="sig-param"><span class="pre">backgroundParamIndices</span></em>, <em class="sig-param"><span class="pre">shiftedData</span></em>, <em class="sig-param"><span class="pre">customFiles</span></em>, <em class="sig-param"><span class="pre">backgroundParamValues</span></em>, <em class="sig-param"><span class="pre">simulationXData</span></em>, <em class="sig-param"><span class="pre">dataIndices</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.common.constructBackground" title="Link to this definition">#</a></dt>
<dd><p>Apply background parameters to the background.</p>
<p>For function backgrounds, this means running the function using the
defined parameters. For data and constant backgrounds, this means taking
any predefined background data and adding any supplied parameters.</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.common.constructResolution">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.common.</span></span><span class="sig-name descname"><span class="pre">constructResolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">resolutionType</span></em>, <em class="sig-param"><span class="pre">resolutionParamIndex</span></em>, <em class="sig-param"><span class="pre">shiftedData</span></em>, <em class="sig-param"><span class="pre">customFiles</span></em>, <em class="sig-param"><span class="pre">resolutionParamValues</span></em>, <em class="sig-param"><span class="pre">simulationXData</span></em>, <em class="sig-param"><span class="pre">dataIndices</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.common.constructResolution" title="Link to this definition">#</a></dt>
<dd><p>Apply resolution parameters to the resolution.</p>
<p>For data and constant resolutions, this means taking any predefined
resolution data and adding any supplied parameters.</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.common.getFitNames">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.common.</span></span><span class="sig-name descname"><span class="pre">getFitNames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">problemStruct</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.common.getFitNames" title="Link to this definition">#</a></dt>
<dd><p>Note that this order of parameters fields is hard-coded by this
routine, packParams, packParamsPriors, and unpackParams</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.common.makeSimulationRange">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.common.</span></span><span class="sig-name descname"><span class="pre">makeSimulationRange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data</span></em>, <em class="sig-param"><span class="pre">simulationLimits</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.common.makeSimulationRange" title="Link to this definition">#</a></dt>
<dd><p>Construct the x data for the simulation. This consists of the x data from
the supplied data, plus additional points above and below the data range
as necessary.</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.common.shiftData">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.common.</span></span><span class="sig-name descname"><span class="pre">shiftData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">scalefactor</span></em>, <em class="sig-param"><span class="pre">qzshift</span></em>, <em class="sig-param"><span class="pre">dataPresent</span></em>, <em class="sig-param"><span class="pre">data</span></em>, <em class="sig-param"><span class="pre">dataLimits</span></em>, <em class="sig-param"><span class="pre">simulationLimits</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.common.shiftData" title="Link to this definition">#</a></dt>
<dd><p>Shifts the data according to scale factor. If there is no data, makes
x-data over the simulation range.</p>
<dl class="simple">
<dt>INPUTS:</dt><dd><ul class="simple">
<li><p>scalefactor: problemStruct.scalefactors</p></li>
<li><p>qzshift: problemStruct.qzshifts</p></li>
<li><p>dataPresent: problemStruct.dataPresent</p></li>
<li><p>data: problemStruct.data</p></li>
<li><p>dataLimits: problemStruct.dataLimits</p></li>
<li><p>simulationLimits: problemStruct.simulationLimits</p></li>
</ul>
</dd>
<dt>OUTPUTS:</dt><dd><ul class="simple">
<li><p>shiftedData: Data shifted using given scale factor</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="mat function" id="module-targetFunctions.common.costFunctions">
<dt class="sig sig-object mat" id="targetFunctions.common.costFunctions.chiSquared">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.common.costFunctions.</span></span><span class="sig-name descname"><span class="pre">chiSquared</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">shiftedData</span></em>, <em class="sig-param"><span class="pre">reflectivity</span></em>, <em class="sig-param"><span class="pre">nParams</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.common.costFunctions.chiSquared" title="Link to this definition">#</a></dt>
<dd><p>Chi-squared function is used to evaluate the goodness of fit.
It is a measure of the difference between the observed and expected
reflectivity.</p>
</dd></dl>

<dl class="mat function" id="module-targetFunctions.common.groupLayers">
<dt class="sig sig-object mat" id="targetFunctions.common.groupLayers.allocateLayersForContrast">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.common.groupLayers.</span></span><span class="sig-name descname"><span class="pre">allocateLayersForContrast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">layerIndices</span></em>, <em class="sig-param"><span class="pre">layerValues</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.common.groupLayers.allocateLayersForContrast" title="Link to this definition">#</a></dt>
<dd><p>Decide which layers are needed for a particular contrast.
This function takes the master array of all layers
and extracts which parameters are required for
a particular contrast.</p>
<dl class="simple">
<dt>INPUTS:</dt><dd><p>layerValues      - List of all the available layers
layerIndices     - Array detailing which layers are required for this contrast</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.common.groupLayers.allocateParamsToLayers">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.common.groupLayers.</span></span><span class="sig-name descname"><span class="pre">allocateParamsToLayers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">paramValues</span></em>, <em class="sig-param"><span class="pre">layersDetails</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.common.groupLayers.allocateParamsToLayers" title="Link to this definition">#</a></dt>
<dd><p>Allocates parameters from the parameter array to the correct layers</p>
<p>This function takes the list of all layers in ‘layersDetails’,
then loops over all the layers, putting in the correct
parameter value from the parameters array into each layer in
the ‘layerValues’ cell array</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.common.groupLayers.groupLayersMod">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.common.groupLayers.</span></span><span class="sig-name descname"><span class="pre">groupLayersMod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">layers</span></em>, <em class="sig-param"><span class="pre">subRoughs</span></em>, <em class="sig-param"><span class="pre">geometry</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.common.groupLayers.groupLayersMod" title="Link to this definition">#</a></dt>
<dd><p>Arrange layers according to geometry.
The paratt calculation proceeds through the z,rho,rough stack; and the
parameter ‘ssub’ is the final roughness encountered.</p>
<ul class="simple">
<li><p>For air/liquid ‘ssub’ is therefore the substrate roughness.</p></li>
<li><p>For solid/liquid, the substrate roughness is the first roughness
encountered, and ‘ssub’ is then the roughness of the outermost layer.</p></li>
</ul>
<p>USAGE:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">outLayers</span><span class="p">,</span> <span class="n">ssubs</span><span class="p">]</span> <span class="o">=</span> <span class="n">groupLayersMod</span><span class="p">(</span><span class="n">resampledLayers</span><span class="p">,</span><span class="n">subRoughs</span><span class="p">,</span><span class="n">geometry</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>INPUTS:</dt><dd><ul class="simple">
<li><p>layers: List of layer values for this contrast.</p></li>
<li><p>subRoughs:  Double of substrate roughness for this contrast.</p></li>
<li><p>geometry: ‘Air / Liquid (or solid)’ or ‘Solid / Liquid’</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><ul class="simple">
<li><p>outputLayers: Layers parameter values for this contrast.</p></li>
<li><p>ssubs: vector of ssub values.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="normal-target-functions-normaltf">
<h2>Normal Target Functions (normalTF)<a class="headerlink" href="#normal-target-functions-normaltf" title="Link to this heading">#</a></h2>
<dl class="mat function" id="module-targetFunctions.+normalTF">
<dt class="sig sig-object mat" id="targetFunctions.+normalTF.coreLayersCalculation">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.normalTF.</span></span><span class="sig-name descname"><span class="pre">coreLayersCalculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">contrastLayers</span></em>, <em class="sig-param"><span class="pre">roughness</span></em>, <em class="sig-param"><span class="pre">geometry</span></em>, <em class="sig-param"><span class="pre">bulkIn</span></em>, <em class="sig-param"><span class="pre">bulkOut</span></em>, <em class="sig-param"><span class="pre">resample</span></em>, <em class="sig-param"><span class="pre">calcSld</span></em>, <em class="sig-param"><span class="pre">shiftedData</span></em>, <em class="sig-param"><span class="pre">simulationXData</span></em>, <em class="sig-param"><span class="pre">dataIndices</span></em>, <em class="sig-param"><span class="pre">repeatLayers</span></em>, <em class="sig-param"><span class="pre">resolution</span></em>, <em class="sig-param"><span class="pre">background</span></em>, <em class="sig-param"><span class="pre">backgroundAction</span></em>, <em class="sig-param"><span class="pre">parallelPoints</span></em>, <em class="sig-param"><span class="pre">resampleMinAngle</span></em>, <em class="sig-param"><span class="pre">resampleNPoints</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.+normalTF.coreLayersCalculation" title="Link to this definition">#</a></dt>
<dd><p>This is the main reflectivity calculation for all layers models in the
normal target function.</p>
<p>The function first arranges the roughness’ in the correct order
according to geometry. Then, if required it calculates the SLD profile
and if requested resamples this into a number of zero-roughness layers
(roughness resampling). It the applies any scalefactors and qz shifts
the data requires. This is done before calculating the reflectivity to
ensure that the reflectivity is calculated over the same range in qz as
the shifted datapoints. The main reflectivity calculation is then
called, including the resolution function. The calculation outputs two
profiles - ‘reflect’ which is the same range as the points, and
‘simulation’ which can be a different range to allow extrapolation.
Finally, the background correction is applied.</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.+normalTF.customLayers">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.normalTF.</span></span><span class="sig-name descname"><span class="pre">customLayers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">problemStruct</span></em>, <em class="sig-param"><span class="pre">controls</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.+normalTF.customLayers" title="Link to this definition">#</a></dt>
<dd><p>The custom layers, normalTF reflectivity calculation.
The function extracts the relevant parameters from the input arrays,
allocates these on a pre-contrast basis, then calls the
‘coreLayersCalculation’ (the core layers normalTF calc is
shared between multiple calculation types).</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.+normalTF.customXY">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.normalTF.</span></span><span class="sig-name descname"><span class="pre">customXY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">problemStruct</span></em>, <em class="sig-param"><span class="pre">controls</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.+normalTF.customXY" title="Link to this definition">#</a></dt>
<dd><p>Extract parameters from problemStruct</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.+normalTF.processCustomFunction">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.normalTF.</span></span><span class="sig-name descname"><span class="pre">processCustomFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">contrastBulkIns</span></em>, <em class="sig-param"><span class="pre">contrastBulkOuts</span></em>, <em class="sig-param"><span class="pre">bulkInValues</span></em>, <em class="sig-param"><span class="pre">bulkOutValues</span></em>, <em class="sig-param"><span class="pre">contrastCustomFiles</span></em>, <em class="sig-param"><span class="pre">numberOfContrasts</span></em>, <em class="sig-param"><span class="pre">numberOfOutputColumns</span></em>, <em class="sig-param"><span class="pre">customFiles</span></em>, <em class="sig-param"><span class="pre">paramValues</span></em>, <em class="sig-param"><span class="pre">useImaginary</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.+normalTF.processCustomFunction" title="Link to this definition">#</a></dt>
<dd><p>Top-level function for processing custom layers for all the
contrasts.</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.+normalTF.standardLayers">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.normalTF.</span></span><span class="sig-name descname"><span class="pre">standardLayers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">problemStruct</span></em>, <em class="sig-param"><span class="pre">controls</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.+normalTF.standardLayers" title="Link to this definition">#</a></dt>
<dd><p>This is the main reflectivity calculation of the standard layers
calculation type. It extracts the required parameters for the contrasts
from the input arrays, then passes the main calculation to
‘coreLayersCalculation’, which carries out the calculation itself.
The core calculation is common for both standard and custom layers.</p>
</dd></dl>

</section>
<section id="domains-target-functions-domainstf">
<h2>Domains Target Functions (domainsTF)<a class="headerlink" href="#domains-target-functions-domainstf" title="Link to this heading">#</a></h2>
<dl class="mat function" id="module-targetFunctions.+domainsTF">
<dt class="sig sig-object mat" id="targetFunctions.+domainsTF.averageReflectivity">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.domainsTF.</span></span><span class="sig-name descname"><span class="pre">averageReflectivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">reflectivity1</span></em>, <em class="sig-param"><span class="pre">reflectivity2</span></em>, <em class="sig-param"><span class="pre">simulation1</span></em>, <em class="sig-param"><span class="pre">simulation2</span></em>, <em class="sig-param"><span class="pre">domainRatio</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.+domainsTF.averageReflectivity" title="Link to this definition">#</a></dt>
<dd><p>Calculates the averaged reflectivity for domains samples (incoherent
sum)</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.+domainsTF.customLayers">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.domainsTF.</span></span><span class="sig-name descname"><span class="pre">customLayers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">problemStruct</span></em>, <em class="sig-param"><span class="pre">controls</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.+domainsTF.customLayers" title="Link to this definition">#</a></dt>
<dd><p>The custom layers, domainsTF reflectivity calculation.
The function extracts the relevant parameters from the input arrays,
allocates these on a pre-contrast basis, then calls the
‘coreLayersCalculation’ (the core layers domainsTF calc is shared
between multiple calculation types).</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.+domainsTF.customXY">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.domainsTF.</span></span><span class="sig-name descname"><span class="pre">customXY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">problemStruct</span></em>, <em class="sig-param"><span class="pre">controls</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.+domainsTF.customXY" title="Link to this definition">#</a></dt>
<dd><p>Extract parameters from problemStruct</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.+domainsTF.processCustomFunction">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.domainsTF.</span></span><span class="sig-name descname"><span class="pre">processCustomFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">contrastBulkIns</span></em>, <em class="sig-param"><span class="pre">contrastBulkOuts</span></em>, <em class="sig-param"><span class="pre">bulkInValues</span></em>, <em class="sig-param"><span class="pre">bulkOutValues</span></em>, <em class="sig-param"><span class="pre">contrastCustomFiles</span></em>, <em class="sig-param"><span class="pre">numberOfContrasts</span></em>, <em class="sig-param"><span class="pre">numberOfOutputColumns</span></em>, <em class="sig-param"><span class="pre">customFiles</span></em>, <em class="sig-param"><span class="pre">paramValues</span></em>, <em class="sig-param"><span class="pre">useImaginary</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.+domainsTF.processCustomFunction" title="Link to this definition">#</a></dt>
<dd><p>Top-level function for processing custom layers for all the
contrasts.</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="targetFunctions.+domainsTF.standardLayers">
<span class="sig-prename descclassname"><span class="pre">targetFunctions.domainsTF.</span></span><span class="sig-name descname"><span class="pre">standardLayers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">problemStruct</span></em>, <em class="sig-param"><span class="pre">controls</span></em><span class="sig-paren">)</span><a class="headerlink" href="#targetFunctions.+domainsTF.standardLayers" title="Link to this definition">#</a></dt>
<dd><p>This is the main reflectivity calculation of the standard layers
calculation type. It extracts the required parameters for the contrasts
from the input arrays, then passes the main calculation to
‘coreLayersCalculation’, which carries out the calculation itself.
The core calculation is common for both standard and custom layers.</p>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-functions">Common Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normal-target-functions-normaltf">Normal Target Functions (normalTF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#domains-target-functions-domainstf">Domains Target Functions (domainsTF)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2022-2025, ISIS Neutron and Muon Source.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>